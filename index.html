
<script>
/* ===========================
   CANVAS SETUP
=========================== */

const canvas = document.getElementById("fx");
const ctx = canvas.getContext("2d");

const canvasTop = document.getElementById("fxTop");
const ctxTop = canvasTop.getContext("2d");

function resize(){
canvas.width = innerWidth;
canvas.height = innerHeight;
canvasTop.width = innerWidth;
canvasTop.height = innerHeight;
}
resize();
addEventListener("resize", resize);

/* ===========================
   AUDIO SETUP
=========================== */

const boomSound = new Audio("https://assets.mixkit.co/sfx/preview/mixkit-firework-explosion-1689.mp3");
boomSound.volume = 0.6;

/* ===========================
   PARTICLES
=========================== */

class Particle{
constructor(x,y,textMode=false){
this.x=x;
this.y=y;
this.angle=Math.random()*Math.PI*2;
this.speed=Math.random()*5+2;
this.life=100;
this.textMode=textMode;
this.trail=[];
this.char=["â™¥","Love","U","I"][Math.floor(Math.random()*4)];
}
update(){
this.trail.push({x:this.x,y:this.y});
if(this.trail.length>6) this.trail.shift();
this.x+=Math.cos(this.angle)*this.speed;
this.y+=Math.sin(this.angle)*this.speed;
this.speed*=0.96;
this.life--;
}
draw(){
for(let t of this.trail){
ctx.fillStyle="rgba(255,150,200,0.2)";
ctx.fillRect(t.x,t.y,2,2);
}
ctx.fillStyle=`rgba(255,150,200,${this.life/100})`;
ctx.font="bold 16px sans-serif";
ctx.fillText(this.char,this.x,this.y);
}
}

class FastParticle{
constructor(x,y){
this.x=x;
this.y=y;
this.angle=Math.random()*Math.PI*2;
this.speed=Math.random()*14+8;
this.life=80;
}
update(){
this.x+=Math.cos(this.angle)*this.speed;
this.y+=Math.sin(this.angle)*this.speed;
this.speed*=0.98;
this.life--;
}
draw(){
ctxTop.fillStyle=`rgba(255,220,0,${this.life/80})`;
ctxTop.beginPath();
ctxTop.arc(this.x,this.y,3,0,Math.PI*2);
ctxTop.fill();
}
}

class Shockwave{
constructor(x,y){
this.x=x;
this.y=y;
this.radius=10;
this.life=30;
}
update(){ this.radius+=15; this.life--; }
draw(){
ctxTop.strokeStyle=`rgba(255,255,255,${this.life/30})`;
ctxTop.lineWidth=4;
ctxTop.beginPath();
ctxTop.arc(this.x,this.y,this.radius,0,Math.PI*2);
ctxTop.stroke();
}
}

class GoldRain{
constructor(){
this.x=Math.random()*canvasTop.width;
this.y=-20;
this.speed=Math.random()*4+3;
this.life=200;
}
update(){ this.y+=this.speed; this.life--; }
draw(){
ctxTop.fillStyle="gold";
ctxTop.fillRect(this.x,this.y,2,8);
}
}

/* ===========================
   ARRAYS
=========================== */

let normalParticles=[];
let fastParticles=[];
let shockwaves=[];
let goldRain=[];

/* ===========================
   FUNCTIONS
=========================== */

function boom(x,y){
for(let i=0;i<120;i++){
normalParticles.push(new Particle(x,y));
}
}

function megaBoom(x,y){

// fast yellow layer
for(let i=0;i<350;i++){
fastParticles.push(new FastParticle(x,y));
}

// shockwave
shockwaves.push(new Shockwave(x,y));

// golden rain
for(let i=0;i<80;i++){
goldRain.push(new GoldRain());
}

// vibration
if(navigator.vibrate){
navigator.vibrate([120,60,200]);
}

// sound
boomSound.currentTime=0;
boomSound.play();

// screen flash
flashScreen();
}

/* FLASH */
function flashScreen(){
const flash=document.createElement("div");
flash.style.position="fixed";
flash.style.inset="0";
flash.style.background="white";
flash.style.opacity="0.7";
flash.style.zIndex="100";
document.body.appendChild(flash);
setTimeout(()=>flash.remove(),100);
}

/* I LOVE YOU FORMATION */
function textFormation(){
const text="I LOVE YOU";
const spacing=40;
let startX=canvas.width/2 - (text.length*spacing)/2;
let y=canvas.height/3;

for(let i=0;i<text.length;i++){
let char=text[i];
if(char!==" "){
for(let j=0;j<15;j++){
let p=new Particle(startX+i*spacing,y,true);
normalParticles.push(p);
}
}
}
}

/* CONTINUOUS EXPLOSION */
setInterval(()=>{
boom(
Math.random()*canvas.width,
Math.random()*canvas.height*0.6
);
},1800);

/* TEXT FORMATION EVERY 8s */
setInterval(()=>{
textFormation();
},8000);

/* ===========================
   ANIMATION LOOP
=========================== */

function animate(){
ctx.fillStyle="rgba(0,0,0,0.2)";
ctx.fillRect(0,0,canvas.width,canvas.height);

ctxTop.clearRect(0,0,canvasTop.width,canvasTop.height);

for(let i=normalParticles.length-1;i>=0;i--){
normalParticles[i].update();
normalParticles[i].draw();
if(normalParticles[i].life<=0)
normalParticles.splice(i,1);
}

for(let i=fastParticles.length-1;i>=0;i--){
fastParticles[i].update();
fastParticles[i].draw();
if(fastParticles[i].life<=0)
fastParticles.splice(i,1);
}

for(let i=shockwaves.length-1;i>=0;i--){
shockwaves[i].update();
shockwaves[i].draw();
if(shockwaves[i].life<=0)
shockwaves.splice(i,1);
}

for(let i=goldRain.length-1;i>=0;i--){
goldRain[i].update();
goldRain[i].draw();
if(goldRain[i].life<=0)
goldRain.splice(i,1);
}

requestAnimationFrame(animate);
}
animate();

/* ===========================
   LONG PRESS
=========================== */

let pressTimer;
let isLong=false;

function startPress(e){
isLong=false;
pressTimer=setTimeout(()=>{
isLong=true;
let x=e.clientX || e.touches[0].clientX;
let y=e.clientY || e.touches[0].clientY;
megaBoom(x,y);
},600);
}

function endPress(e){
clearTimeout(pressTimer);
if(!isLong){
let x=e.clientX || (e.changedTouches && e.changedTouches[0].clientX);
let y=e.clientY || (e.changedTouches && e.changedTouches[0].clientY);
if(x && y) boom(x,y);
}
}

addEventListener("mousedown",startPress);
addEventListener("mouseup",endPress);
addEventListener("touchstart",startPress);
addEventListener("touchend",endPress);
</script>










